---
title: "Adding a Credential to an Existing Wallet"
sidebar_position: 6
description: Adding a Credential to an Existing Wallet
slug: /embedded-wallets/code-examples/add-credential
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import Parameter from "@site/src/components/parameter";

#### 1. Initialize the Passkey Client

Begin by initializing the Turnkey SDK with your organization ID and API base URL, and then initialize the Passkey Client.

```typescript
import { Turnkey, TurnkeySDKBrowserConfig } from "@turnkey/sdk-browser";

// Initialize the Turnkey SDK with your organization ID and API base URL
const turnkey = new Turnkey({
  rpId: process.env.TURNKEY_RP_ID,
  apiBaseUrl: process.env.TURNKEY_API_BASE_URL,
  defaultOrganizationId: process.env.TURNKEY_ORGANIZATION_ID,
});

// Initialize the Passkey Client
const passkeyClient = turnkey.passkeyClient();
```

#### 2. Call the `login` function

Now that you have initialized the Passkey Client, you can call the `login` function which will prompt the
user to authenticate with their passkey. Additionally, this function will set the current user in
local storage upon successful authentication, which will be used later when creating the authenticator.

```typescript
const response = await passkeyClient.login();
if (response.organizationId) {
  console.log("User authenticated successfully");
} else {
  console.log("User authentication failed");
}
```

#### 3. Create a new user passkey credential

Now that you have authenticated the user, you can call the `createUserPasskey` function to create a new user passkey credential.

```typescript
const credential = await passkeyClient.createUserPasskey({
  publicKey: {
    rp: {
      name: "Wallet Passkey",
    },
    user: {
      name: "satoshi",
      displayName: "Satoshi",
    },
  },
});
```

#### 4. Add the credential to the wallet

Now that you have created a new user passkey credential, we'll use this credential to create a new passkey authenticator for the user.
We'll need the userId to create the authenticator, so we'll get the current user first. This value comes from local storage which is
set when the user successfully logs in via the `login` function.

```typescript
// First, get the current user, we'll need the userId to create the authenticator
const user = await turnkey?.getCurrentUser();

const authenticatorsResponse = await turnkey.createAuthenticators({
  authenticators: [
    {
      authenticatorName: "New Passkey Authenticator",
      challenge: credential.encodedChallenge,
      attestation: credential.attestation,
    },
  ],
  userId: user.userId,
});

// Check if the authenticator was created successfully
if (authenticatorsResponse?.activity.id) {
  console.log("Authenticator created successfully");
}
```
